<!-- 
 Mini E-Commere  (Kart Gurluşy) + localStorage + sessionStorage

- 3 sany haryt kartasy (Bootstrap card görnüşinde).
- “Sebede Goş” düwmesine basylanda:
  • Haryt sebede goşulýar.
  • Sebediň mazmuny localStorage-da saklanýar (sahypa täzelenende-de ýitmeýär).
  • Iň soň goşulan harydyň ady sessionStorage-a ýazylýar we ýokarda 
    “Bu oturumda iň soň goşan harydyň…” diýip görkezilýär.
  • Sag ýok burçdaky “Sebet (X)” düwmesinde sebediň sany görkezilýär.
-->










<!DOCTYPE html>
<html lang="tk">
<head>
    <meta charset="UTF-8">
    <title>Mini Sebet Mysaly</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f5f5f5;
        }
        .navbar {
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .product-card {
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            transition: transform 0.15s ease, box-shadow 0.15s ease;
        }
        .product-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 16px 30px rgba(0,0,0,0.12);
        }
        .product-img {
            height: 180px;
            object-fit: cover;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg bg-white">
    <div class="container">
        <a class="navbar-brand fw-bold" href="#">WebDükan</a>
        <button class="btn btn-outline-primary ms-auto" id="cartButton">
            Sebet (<span id="cartCount">0</span>)
        </button>
    </div>
</nav>

<div class="container py-4">
    <div id="lastAddedInfo" class="alert alert-info d-none mb-4"></div>

    <div class="row g-4">
        <div class="col-md-4">
            <div class="card product-card">
                <img src="https://picsum.photos/seed/laptop/400/250" class="card-img-top product-img" alt="Noutbuk">
                <div class="card-body">
                    <h5 class="card-title">Programmist Noutbuk</h5>
                    <p class="card-text text-muted">
                        Programmistler üçin ýokary öndürijilikli noutbuk.
                    </p>
                    <p class="fw-bold mb-3">32 500 TMT</p>
                    <button class="btn btn-primary w-100 add-to-cart"
                            data-id="1"
                            data-name="Programmist Noutbuk"
                            data-price="32500">
                        Sebede Goş
                    </button>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card product-card">
                <img src="https://picsum.photos/seed/headphones/400/250" class="card-img-top product-img" alt="Naushnik">
                <div class="card-body">
                    <h5 class="card-title">Wireless Naushnik</h5>
                    <p class="card-text text-muted">
                        Şowhun boýundan goragly we amatly eşitdiriji.
                    </p>
                    <p class="fw-bold mb-3">2 400 TMT</p>
                    <button class="btn btn-primary w-100 add-to-cart"
                            data-id="2"
                            data-name="Wireless Naushnik"
                            data-price="2400">
                        Sebede Goş
                    </button>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card product-card">
                <img src="https://picsum.photos/seed/monitor/400/250" class="card-img-top product-img" alt="Monitor">
                <div class="card-body">
                    <h5 class="card-title">27" 2K Monitor</h5>
                    <p class="card-text text-muted">
                        Giň iş meýdany isleýänler üçin owadan monitor.
                    </p>
                    <p class="fw-bold mb-3">5 900 TMT</p>
                    <button class="btn btn-primary w-100 add-to-cart"
                            data-id="3"
                            data-name='27" 2K Monitor'
                            data-price="5900">
                        Sebede Goş
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="cartModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-end">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Sebediňiz</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <ul class="list-group mb-3" id="cartList"></ul>
                    <div class="d-flex justify-content-between">
                        <strong>Jemi:</strong>
                        <strong id="cartTotal">0 TMT</strong>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-danger" id="clearCartBtn">Sebedi Arassala</button>
                    <button class="btn btn-success" data-bs-dismiss="modal">Satylyşyga Dowam Et</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let cart = [];

    document.addEventListener("DOMContentLoaded", () => {
        loadCartFromStorage();
        showLastAdded();
        updateCartCount();
    });

    document.querySelectorAll(".add-to-cart").forEach(button => {
        button.addEventListener("click", function () {
            const product = {
                id: this.dataset.id,
                name: this.dataset.name,
                price: Number(this.dataset.price)
            };

            addToCart(product);
        });
    });

   document.addEventListener("DOMContentLoaded", () => {

    const cartModal = new bootstrap.Modal(document.getElementById("cartModal"));

    document.getElementById("cartButton").addEventListener("click", () => {
        renderCart();
        cartModal.show();
    });
});


    document.getElementById("clearCartBtn").addEventListener("click", clearCart);



    function addToCart(product) {
        cart.push(product);

        localStorage.setItem("cart", JSON.stringify(cart));

        sessionStorage.setItem("lastAdded", product.name);

        updateCartCount();
        showLastAdded();

    }

    function loadCartFromStorage() {
        const stored = localStorage.getItem("cart");
        if (stored) {
            cart = JSON.parse(stored);
        }
    }

    function updateCartCount() {
        document.getElementById("cartCount").textContent = cart.length;
    }

    function showLastAdded() {
        const name = sessionStorage.getItem("lastAdded");
        const infoBox = document.getElementById("lastAddedInfo");

        if (name) {
            infoBox.textContent = "Bu oturumda iň soň goşan harydyň: " + name;
            infoBox.classList.remove("d-none");
        }
    }

    function renderCart() {
        const list = document.getElementById("cartList");
        const totalBox = document.getElementById("cartTotal");

        list.innerHTML = "";
        let total = 0;

        cart.forEach(item => {
            const li = document.createElement("li");
            li.className = "list-group-item d-flex justify-content-between";
            li.innerHTML = `
                <span>${item.name}</span>
                <strong>${item.price} TMT</strong>
            `;
            list.appendChild(li);

            total += item.price;
        });

        totalBox.textContent = total + " TMT";
    }

    function clearCart() {
    cart = [];
    localStorage.removeItem("cart");
    sessionStorage.removeItem("lastAdded"); 
    updateCartCount();
    renderCart();

    const infoBox = document.getElementById("lastAddedInfo");
    infoBox.classList.add("d-none");
}

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
